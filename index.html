<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vaani â€” Free Multilingual Translator</title>
  <meta name="description" content="Free multilingual translator for Telugu, Hindi, Tamil, Kannada, Malayalam and Bengali. WhatsApp-ready copy with NLP analysis."/>
  <meta name="theme-color" content="#6366f1"/>
  <meta property="og:title" content="Vaani â€” Free Multilingual Translator"/>
  <meta property="og:description" content="Translate English & Tenglish to 6 Indian languages. Free, no login, WhatsApp-ready."/>
  <meta property="og:type" content="website"/>
  <link rel="manifest" href="manifest.json"/>
  <link rel="apple-touch-icon" href="icon.png"/>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <style>*{box-sizing:border-box;margin:0;padding:0;}body{background:#08090f;}#root{min-height:100vh;}</style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const { useState, useRef, useCallback } = React;

/* â”€â”€â”€ STYLES â”€â”€â”€ */
const CSS = (d) => `
@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+Telugu:wght@400;600&family=Noto+Sans+Devanagari:wght@400;600&family=Inter:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap');
*{box-sizing:border-box;margin:0;padding:0;}
:root{
  --bg:${d?"#08090f":"#f5f5f7"};--bg2:${d?"#0e0f1c":"#e8e8ed"};
  --surf:${d?"rgba(255,255,255,.05)":"rgba(0,0,0,.04)"};
  --surf2:${d?"rgba(255,255,255,.09)":"rgba(0,0,0,.07)"};
  --brd:${d?"rgba(255,255,255,.09)":"rgba(0,0,0,.1)"};
  --txt:${d?"#e6e0d8":"#111118"};
  --muted:${d?"rgba(230,224,216,.38)":"rgba(17,17,24,.38)"};
  --acc:#6366f1;--acc2:#8b5cf6;--grn:#10b981;--red:#ef4444;--gold:#f59e0b;--sky:#0ea5e9;--pink:#ec4899;
}
body{background:var(--bg);color:var(--txt);font-family:'Inter',sans-serif;transition:background .3s,color .3s;}
@keyframes fadeUp{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes growW{from{width:0}to{width:var(--w)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.35}}
@keyframes slideDown{from{opacity:0;transform:translateY(-8px)}to{opacity:1;transform:translateY(0)}}
.page{min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:0 0 80px;
  background-image:radial-gradient(ellipse at 10% 0%,rgba(99,102,241,.09) 0%,transparent 55%),
  radial-gradient(ellipse at 90% 100%,rgba(139,92,246,.06) 0%,transparent 55%);}
.nav{width:100%;max-width:980px;display:flex;align-items:center;justify-content:space-between;padding:22px 20px;margin-bottom:8px;}
.brand{display:flex;align-items:center;gap:10px;}
.b-ico{width:34px;height:34px;border-radius:10px;background:linear-gradient(135deg,var(--acc),var(--acc2));display:flex;align-items:center;justify-content:center;font-size:17px;}
.b-name{font-size:19px;font-weight:700;letter-spacing:-.02em;}
.b-tag{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;margin-top:1px;}
.nav-r{display:flex;gap:7px;align-items:center;}
.pill{padding:6px 13px;border-radius:999px;border:1px solid var(--brd);background:var(--surf);color:var(--muted);font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.07em;text-transform:uppercase;cursor:pointer;transition:all .15s;display:flex;align-items:center;gap:5px;}
.pill:hover{border-color:var(--acc);color:var(--acc);}
.pill.on{background:linear-gradient(135deg,var(--acc),var(--acc2));color:#fff;border-color:transparent;}
.round{width:33px;height:33px;border-radius:50%;border:1px solid var(--brd);background:var(--surf);cursor:pointer;font-size:15px;display:flex;align-items:center;justify-content:center;transition:all .15s;}
.round:hover{background:var(--surf2);}
.src-wrap{width:100%;max-width:980px;padding:0 20px;margin-bottom:14px;}
.src-bar{display:flex;align-items:center;gap:10px;flex-wrap:wrap;}
.src-lbl{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);flex-shrink:0;}
.src-chips{display:flex;gap:6px;flex-wrap:wrap;}
.src-chip{display:flex;align-items:center;gap:7px;padding:7px 13px;border-radius:11px;border:1px solid var(--brd);background:var(--surf);cursor:pointer;transition:all .15s;font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.05em;color:var(--muted);}
.src-chip:hover{border-color:var(--acc);color:var(--acc);}
.src-chip.active{border-color:rgba(99,102,241,.5);background:rgba(99,102,241,.1);color:var(--acc);}
.src-chip.s-auto.active{border-color:rgba(139,92,246,.5);background:rgba(139,92,246,.1);color:var(--acc2);}
.src-chip.s-claude.active{border-color:rgba(99,102,241,.5);background:rgba(99,102,241,.1);color:var(--acc);}
.src-chip.s-google.active{border-color:rgba(66,133,244,.5);background:rgba(66,133,244,.1);color:#4285f4;}
.src-chip.s-mymemory.active{border-color:rgba(245,158,11,.5);background:rgba(245,158,11,.1);color:var(--gold);}
.src-chip.s-lingva.active{border-color:rgba(16,185,129,.5);background:rgba(16,185,129,.1);color:var(--grn);}
.src-ico{width:18px;height:18px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:11px;font-family:'DM Mono',monospace;font-weight:700;}
.src-name{font-weight:600;}
.src-note{font-size:9px;opacity:.6;margin-top:1px;}
.src-badge{display:inline-flex;align-items:center;gap:5px;padding:3px 9px;border-radius:6px;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.08em;text-transform:uppercase;border:1px solid;animation:fadeUp .25s ease;}
.src-badge.b-auto    {background:rgba(139,92,246,.1);border-color:rgba(139,92,246,.3);color:var(--acc2);}
.src-badge.b-claude  {background:rgba(99,102,241,.1);border-color:rgba(99,102,241,.3);color:var(--acc);}
.src-badge.b-google  {background:rgba(66,133,244,.1);border-color:rgba(66,133,244,.3);color:#4285f4;}
.src-badge.b-mymemory{background:rgba(245,158,11,.1);border-color:rgba(245,158,11,.3);color:var(--gold);}
.src-badge.b-lingva  {background:rgba(16,185,129,.1);border-color:rgba(16,185,129,.3);color:var(--grn);}
.src-badge.b-failed  {background:rgba(239,68,68,.1); border-color:rgba(239,68,68,.3); color:var(--red);}
.ff-wrap{width:100%;max-width:980px;padding:0 20px;margin-bottom:14px;}
.ff-panel{background:var(--surf);border:1px solid var(--brd);border-radius:16px;overflow:hidden;animation:slideDown .25s ease;}
.ff-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--brd);cursor:pointer;}
.ff-title{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.15em;text-transform:uppercase;color:var(--muted);}
.ff-body{padding:14px 16px;display:flex;flex-wrap:wrap;gap:8px;}
.ff-chip{display:flex;align-items:center;gap:7px;padding:7px 13px;border-radius:10px;border:1px solid var(--brd);background:var(--surf);cursor:pointer;transition:all .15s;user-select:none;}
.ff-chip:hover{border-color:var(--acc);}
.ff-chip.on{border-color:rgba(99,102,241,.4);background:rgba(99,102,241,.1);}
.ff-label{font-size:13px;font-weight:500;}
.ff-sub{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);letter-spacing:.05em;text-transform:uppercase;margin-top:1px;}
.toggle{width:32px;height:18px;border-radius:99px;transition:background .2s;position:relative;flex-shrink:0;}
.toggle.on{background:var(--acc);}.toggle.off{background:var(--brd);}
.toggle-dot{position:absolute;top:3px;width:12px;height:12px;border-radius:50%;background:#fff;transition:left .2s;box-shadow:0 1px 3px rgba(0,0,0,.25);}
.toggle.on .toggle-dot{left:17px;}.toggle.off .toggle-dot{left:3px;}
.lbar{width:100%;max-width:980px;padding:0 20px;display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:14px;}
.lbl{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);flex-shrink:0;}
.lchips{display:flex;gap:6px;flex-wrap:wrap;}
.lchip{padding:5px 13px;border-radius:999px;border:1px solid var(--brd);background:transparent;cursor:pointer;font-family:'DM Mono',monospace;font-size:11px;color:var(--muted);transition:all .15s;display:flex;align-items:center;gap:5px;}
.lchip:hover{border-color:var(--acc);color:var(--acc);}
.lchip.on{background:linear-gradient(135deg,var(--acc),var(--acc2));color:#fff;border-color:transparent;}
.mrow{width:100%;max-width:980px;padding:0 20px;display:flex;align-items:center;gap:8px;min-height:22px;margin-bottom:8px;flex-wrap:wrap;}
.mbadge{display:inline-flex;align-items:center;gap:5px;padding:3px 10px;border-radius:999px;border:1px solid;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.1em;text-transform:uppercase;}
.mbadge.english{background:rgba(16,185,129,.08);border-color:rgba(16,185,129,.25);color:var(--grn);}
.mbadge.tenglish{background:rgba(139,92,246,.08);border-color:rgba(139,92,246,.25);color:var(--acc2);}
.mbadge.det{background:var(--surf);border-color:var(--brd);color:var(--muted);}
.mbadge.api-ok{background:rgba(16,185,129,.08);border-color:rgba(16,185,129,.2);color:var(--grn);}
.mbadge.api-err{background:rgba(239,68,68,.08);border-color:rgba(239,68,68,.2);color:var(--red);}
.api-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0;}
.api-dot.ok{background:var(--grn);animation:pulse 2.5s infinite;}
.api-dot.err{background:var(--red);}
.api-dot.pend{background:var(--gold);animation:pulse 1s infinite;}
.main{width:100%;max-width:980px;padding:0 20px;display:flex;flex-direction:column;gap:12px;}
.panels{display:grid;grid-template-columns:1fr 42px 1fr;gap:0;align-items:stretch;}
.panel{background:var(--surf);border:1px solid var(--brd);border-radius:18px;overflow:hidden;display:flex;flex-direction:column;transition:border-color .2s;}
.panel:focus-within{border-color:rgba(99,102,241,.38);}
.ph{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--brd);}
.ph-lbl{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);}
.ph-name{font-size:13px;font-weight:600;margin-top:2px;}
.ph-right{display:flex;flex-direction:column;align-items:flex-end;gap:4px;}
.ph-cnt{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);}
textarea{flex:1;background:transparent;border:none;outline:none;resize:none;padding:15px 17px;font-family:'Inter',sans-serif;font-size:15px;line-height:1.7;color:var(--txt);min-height:140px;caret-color:var(--acc);}
textarea::placeholder{color:var(--muted);font-style:italic;}
.pa{display:flex;align-items:center;gap:6px;padding:9px 12px;border-top:1px solid var(--brd);flex-wrap:wrap;}
.ib{background:var(--surf);border:1px solid var(--brd);border-radius:7px;color:var(--muted);cursor:pointer;padding:4px 10px;font-size:10px;font-family:'DM Mono',monospace;transition:all .15s;display:flex;align-items:center;gap:4px;}
.ib:hover{background:var(--surf2);color:var(--txt);}
.ib:disabled{opacity:.3;cursor:not-allowed;}
.ib.ok{background:rgba(16,185,129,.12);border-color:var(--grn);color:var(--grn);}
.arr{display:flex;align-items:center;justify-content:center;padding:0 5px;}
.arrc{width:38px;height:38px;border-radius:50%;background:linear-gradient(135deg,var(--acc),var(--acc2));border:none;cursor:pointer;color:#fff;font-size:15px;display:flex;align-items:center;justify-content:center;transition:transform .2s,box-shadow .2s;box-shadow:0 3px 12px rgba(99,102,241,.32);}
.arrc:hover:not(:disabled){transform:scale(1.08);}
.arrc:disabled{opacity:.35;cursor:not-allowed;}
.ob{flex:1;padding:15px 17px;min-height:140px;display:flex;flex-direction:column;gap:7px;}
.o-script{font-family:'Noto Serif Telugu',serif;font-size:19px;line-height:1.9;}
.o-deva{font-family:'Noto Sans Devanagari',sans-serif;font-size:17px;line-height:1.9;}
.o-ph{color:var(--muted);font-style:italic;font-size:14px;margin:auto;align-self:center;}
.o-eng{padding-top:8px;border-top:1px solid var(--brd);}
.o-el{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);margin-bottom:3px;}
.o-et{font-size:12px;line-height:1.6;color:var(--muted);font-style:italic;}
.err{color:var(--red);font-family:'DM Mono',monospace;font-size:10px;padding:7px 14px;border-top:1px solid rgba(239,68,68,.15);}
.cta{width:100%;padding:14px;background:linear-gradient(135deg,var(--acc),var(--acc2));border:none;border-radius:13px;color:#fff;font-size:15px;font-weight:600;cursor:pointer;transition:opacity .2s,transform .15s;box-shadow:0 4px 16px rgba(99,102,241,.28);display:flex;align-items:center;justify-content:center;gap:9px;}
.cta:hover:not(:disabled){opacity:.9;transform:translateY(-1px);}
.cta:disabled{opacity:.38;cursor:not-allowed;}
.wa-wrap{background:var(--surf);border:1px solid var(--brd);border-radius:16px;overflow:hidden;animation:fadeUp .3s ease;}
.wa-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--brd);}
.wa-title{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.14em;text-transform:uppercase;color:var(--muted);}
.wa-body{padding:14px 16px;display:flex;flex-direction:column;gap:10px;}
.wa-preview{background:var(--bg2);border:1px solid var(--brd);border-radius:10px;padding:10px 13px;font-size:13px;line-height:1.6;white-space:pre-wrap;word-break:break-word;min-height:40px;}
.wa-actions{display:flex;gap:7px;flex-wrap:wrap;}
.wa-btn{display:flex;align-items:center;gap:6px;padding:9px 16px;border-radius:10px;border:1px solid var(--brd);background:var(--surf);color:var(--muted);font-size:13px;font-weight:500;cursor:pointer;transition:all .15s;}
.wa-btn:hover{border-color:#25d366;color:#25d366;background:rgba(37,211,102,.07);}
.wa-btn.ok{background:rgba(37,211,102,.12);border-color:#25d366;color:#25d366;}
.wa-btn.tg:hover{border-color:#0088cc;color:#0088cc;background:rgba(0,136,204,.07);}
.wa-btn.tg.ok{background:rgba(0,136,204,.12);border-color:#0088cc;color:#0088cc;}
.wa-btn.cp:hover{border-color:var(--acc);color:var(--acc);background:rgba(99,102,241,.07);}
.wa-btn.cp.ok{background:rgba(99,102,241,.12);border-color:var(--acc);color:var(--acc);}
.fmt-wrap{background:var(--bg2);border:1px solid var(--brd);border-radius:10px;padding:12px 13px;display:flex;flex-direction:column;gap:8px;}
.fmt-lbl{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.13em;text-transform:uppercase;color:var(--muted);}
.fmt-tags{display:flex;gap:5px;flex-wrap:wrap;}
.fmt-tag{padding:3px 9px;border-radius:6px;border:1px solid var(--brd);background:var(--surf);font-family:'DM Mono',monospace;font-size:10px;color:var(--muted);cursor:pointer;transition:all .13s;}
.fmt-tag:hover{border-color:var(--acc);color:var(--acc);}
.nlp-section{display:flex;flex-direction:column;gap:10px;animation:fadeUp .4s ease;}
.section-title{font-family:'DM Mono',monospace;font-size:10px;letter-spacing:.18em;text-transform:uppercase;color:var(--muted);padding:0 2px;}
.nlp-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.nlp-grid-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;}
.card{background:var(--surf);border:1px solid var(--brd);border-radius:14px;overflow:hidden;}
.card-h{display:flex;align-items:center;gap:7px;padding:11px 14px;border-bottom:1px solid var(--brd);}
.card-ico{width:24px;height:24px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:12px;flex-shrink:0;}
.ic-a{background:rgba(245,158,11,.12);}.ic-k{background:rgba(14,165,233,.1);}.ic-e{background:rgba(236,72,153,.1);}
.ic-r{background:rgba(16,185,129,.1);}.ic-t{background:rgba(139,92,246,.1);}.ic-s{background:rgba(99,102,241,.1);}.ic-n{background:rgba(239,68,68,.1);}
.card-title{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);}
.card-body{padding:12px 14px;}
.sent-top{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:10px;}
.sent-score{font-size:32px;font-weight:700;line-height:1;}
.sent-lbl{font-family:'DM Mono',monospace;font-size:9px;text-transform:uppercase;letter-spacing:.1em;margin-top:3px;opacity:.7;}
.sent-emo{font-size:26px;}
.bars{display:flex;flex-direction:column;gap:6px;}
.bar-row{display:flex;align-items:center;gap:7px;}
.bar-k{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);width:50px;flex-shrink:0;text-transform:capitalize;}
.bar-track{flex:1;height:4px;background:var(--brd);border-radius:99px;overflow:hidden;}
.bar-fill{height:100%;border-radius:99px;animation:growW .55s ease forwards;width:var(--w);}
.bar-fill.positive{background:linear-gradient(90deg,#10b981,#34d399);}
.bar-fill.negative{background:linear-gradient(90deg,#ef4444,#f87171);}
.bar-fill.neutral{background:linear-gradient(90deg,#64748b,#94a3b8);}
.bar-pct{font-family:'DM Mono',monospace;font-size:9px;color:var(--muted);width:24px;text-align:right;}
.kw-cloud{display:flex;flex-wrap:wrap;gap:5px;}
.kw-tag{padding:4px 10px;border-radius:7px;border:1px solid var(--brd);font-size:12px;font-weight:500;background:var(--surf);}
.kw-tag.h1{background:rgba(99,102,241,.14);border-color:rgba(99,102,241,.3);color:var(--acc);font-weight:600;}
.kw-tag.h2{background:rgba(139,92,246,.09);border-color:rgba(139,92,246,.2);color:var(--acc2);}
.kw-tag.h3{background:var(--surf2);color:var(--txt);}
.kw-score{font-family:'DM Mono',monospace;font-size:9px;opacity:.45;margin-left:3px;}
.ent-list{display:flex;flex-direction:column;gap:6px;}
.ent-row{display:flex;align-items:center;gap:7px;}
.ent-badge{padding:2px 7px;border-radius:5px;font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.07em;text-transform:uppercase;flex-shrink:0;}
.ent-badge.PERSON{background:rgba(236,72,153,.12);color:var(--pink);}
.ent-badge.PLACE{background:rgba(14,165,233,.12);color:var(--sky);}
.ent-badge.ORG{background:rgba(245,158,11,.12);color:var(--gold);}
.ent-badge.OTHER{background:var(--surf2);color:var(--muted);}
.ent-name{font-size:12px;font-weight:500;}
.read-score{font-size:40px;font-weight:700;line-height:1;margin-bottom:2px;}
.read-grade{font-family:'DM Mono',monospace;font-size:10px;text-transform:uppercase;letter-spacing:.1em;opacity:.6;margin-bottom:8px;}
.read-meter{height:7px;background:var(--brd);border-radius:99px;overflow:hidden;margin-bottom:7px;}
.read-fill{height:100%;border-radius:99px;transition:width .7s ease;}
.read-desc{font-size:11px;color:var(--muted);line-height:1.5;}
.tone-grid{display:grid;grid-template-columns:1fr 1fr;gap:6px;}
.tone-item{padding:7px 9px;border-radius:9px;border:1px solid var(--brd);background:var(--surf);}
.tone-item.hi{border-color:rgba(99,102,241,.35);background:rgba(99,102,241,.07);}
.tone-lbl{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.09em;text-transform:uppercase;color:var(--muted);margin-bottom:2px;}
.tone-val{font-size:12px;font-weight:600;text-transform:capitalize;}
.stats-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:7px;}
.stat-box{padding:9px;border-radius:9px;background:var(--surf2);text-align:center;}
.stat-n{font-family:'DM Mono',monospace;font-size:18px;font-weight:600;color:var(--acc);}
.stat-l{font-family:'DM Mono',monospace;font-size:8px;text-transform:uppercase;letter-spacing:.08em;color:var(--muted);margin-top:2px;}
.sum-text{font-size:13px;line-height:1.7;color:var(--muted);font-style:italic;margin-bottom:9px;}
.sum-divider{height:1px;background:var(--brd);margin:8px 0;}
.cmp-lbl{font-family:'DM Mono',monospace;font-size:9px;letter-spacing:.12em;text-transform:uppercase;color:var(--muted);margin-bottom:3px;}
.cmp-txt{font-size:13px;line-height:1.65;}
.cmp-txt.tel{font-family:'Noto Serif Telugu',serif;font-size:14px;line-height:1.9;}
.cmp-txt.dev{font-family:'Noto Sans Devanagari',sans-serif;font-size:13px;line-height:1.9;}
.spin{width:14px;height:14px;border:2px solid rgba(255,255,255,.25);border-top-color:#fff;border-radius:50%;animation:spin .6s linear infinite;}
.footer{text-align:center;font-family:DM Mono,monospace;font-size:10px;color:var(--muted);letter-spacing:.1em;text-transform:uppercase;padding-top:8px;}
@media(max-width:640px){
  .panels{grid-template-columns:1fr;}
  .nlp-grid,.nlp-grid-3{grid-template-columns:1fr;}
  .wa-actions{flex-direction:column;}
}`;

/* â”€â”€â”€ SOURCES â”€â”€â”€ */
const SOURCES = [
  {key:"auto",    name:"Auto",    note:"Best available", ico:"âš¡",color:"var(--acc2)"},
  {key:"claude",  name:"Claude",  note:"AI Â· Guaranteed",ico:"âœ¦", color:"var(--acc)"},
  {key:"google",  name:"Google",  note:"Needs network",  ico:"G", color:"#4285f4"},
  {key:"mymemory",name:"MyMemory",note:"5k/day free",    ico:"M", color:"var(--gold)"},
  {key:"lingva",  name:"Lingva",  note:"Open source",    ico:"L", color:"var(--grn)"},
];

/* â”€â”€â”€ CONSTANTS â”€â”€â”€ */
const LANGS = [
  {code:"te",name:"Telugu",   flag:"ğŸ‡®ğŸ‡³",mm:"en|te",font:"o-script",cmp:"tel"},
  {code:"hi",name:"Hindi",    flag:"ğŸ‡®ğŸ‡³",mm:"en|hi",font:"o-deva",  cmp:"dev"},
  {code:"ta",name:"Tamil",    flag:"ğŸ‡®ğŸ‡³",mm:"en|ta",font:"o-script",cmp:"tel"},
  {code:"kn",name:"Kannada",  flag:"ğŸ‡®ğŸ‡³",mm:"en|kn",font:"o-script",cmp:"tel"},
  {code:"ml",name:"Malayalam",flag:"ğŸ‡®ğŸ‡³",mm:"en|ml",font:"o-script",cmp:"tel"},
  {code:"bn",name:"Bengali",  flag:"ğŸ‡§ğŸ‡©",mm:"en|bn",font:"o-deva",  cmp:"dev"},
];

const SENT_META = {
  positive:{color:"#10b981",emo:"ğŸ˜Š",label:"Positive"},
  negative:{color:"#ef4444",emo:"ğŸ˜”",label:"Negative"},
  neutral: {color:"#64748b",emo:"ğŸ˜",label:"Neutral"},
  mixed:   {color:"#f59e0b",emo:"ğŸ¤”",label:"Mixed"},
};

const READ_GRADES = [
  {max:30, label:"Very Hard",  color:"#ef4444",desc:"Academic â€” complex for most readers."},
  {max:50, label:"Difficult",  color:"#f97316",desc:"College level â€” challenging but manageable."},
  {max:60, label:"Fairly Hard",color:"#f59e0b",desc:"High school â€” some effort required."},
  {max:70, label:"Standard",   color:"#10b981",desc:"Conversational â€” understood by most adults."},
  {max:80, label:"Easy",       color:"#06b6d4",desc:"Simple and clear â€” wide accessibility."},
  {max:100,label:"Very Easy",  color:"#6366f1",desc:"Plain language â€” anyone can understand."},
];

const FLAG_CONFIG = [
  {key:"translator", label:"Translator",   sub:"Core", ico:"ğŸ”¤",always:true},
  {key:"whatsapp",   label:"Messaging",    sub:"Share",ico:"ğŸ’¬"},
  {key:"sentiment",  label:"Sentiment",    sub:"NLP",  ico:"ğŸ’¬"},
  {key:"keywords",   label:"Keywords",     sub:"NLP",  ico:"ğŸ”‘"},
  {key:"entities",   label:"Entities",     sub:"NLP",  ico:"ğŸ·ï¸"},
  {key:"tone",       label:"Tone",         sub:"NLP",  ico:"ğŸ­"},
  {key:"readability",label:"Readability",  sub:"NLP",  ico:"ğŸ“–"},
  {key:"stats",      label:"Text Stats",   sub:"NLP",  ico:"ğŸ“Š"},
  {key:"summary",    label:"Summary",      sub:"NLP",  ico:"ğŸ“"},
];

const DEFAULT_FLAGS = {translator:true,whatsapp:true,sentiment:true,keywords:true,entities:true,tone:true,readability:true,stats:true,summary:true};
const DEFAULT_FMT = "ğŸŒ *{lang} Translation*\n\n{translation}\n\n_{english}_\n\nğŸ”— via {source}";
const FMT_TOKENS = [
  {token:"{translation}",label:"Translation"},{token:"{english}",label:"English"},
  {token:"{lang}",label:"Language"},{token:"{original}",label:"Original"},
  {token:"{source}",label:"Source"},{token:"\\n",label:"New Line"},
  {token:"*text*",label:"Bold"},{token:"_text_",label:"Italic"},
];
const TENGLISH_WORDS = new Set(["nuvvu","meeru","memu","mana","nenu","adi","idi","emi","ela","ikkade","akkade","vachadu","poyadu","chestunna","cheppadu","anadu","ledu","undi","avutundi","chala","super","bagunna","manchiga","nijam","kaadu","ayindi","chesadu","okasari","rendu","moodu","naalugu","aidu","ante","kani","kanna","tho","ki","lo","nu","ni","ku","gurinchi","tarvata","mundu"]);

/* â”€â”€â”€ HELPERS â”€â”€â”€ */
const pct = v=>`${Math.round((v||0)*100)}%`;
const readMeta = s=>READ_GRADES.find(g=>s<=g.max)||READ_GRADES.at(-1);
const textStats = txt=>{
  const words=txt.trim().split(/\s+/).filter(Boolean);
  const sentences=txt.split(/[.!?]+/).filter(s=>s.trim().length>1);
  const chars=txt.replace(/\s/g,"").length;
  const avgWL=words.length?Math.round(chars/words.length*10)/10:0;
  const syllables=words.reduce((a,w)=>a+Math.max(1,w.toLowerCase().replace(/[^aeiouy]/g,"").length),0);
  const fk=words.length&&sentences.length?Math.max(0,Math.min(100,206.835-1.015*(words.length/sentences.length)-84.6*(syllables/words.length))):0;
  return {words:words.length,sentences:sentences.length,chars,avgWL,syllables,fk:Math.round(fk)};
};
const detectTenglish=txt=>{const w=txt.toLowerCase().split(/\s+/);return w.filter(x=>TENGLISH_WORDS.has(x)).length/w.length>0.18;};
const analyzeSentiment=txt=>{
  const pos=["good","great","excellent","amazing","wonderful","love","happy","joy","positive","best","perfect","fantastic","awesome","nice","beautiful","helpful","thanks","thank"];
  const neg=["bad","terrible","awful","hate","sad","negative","worst","horrible","poor","disappointing","useless","broken","fail","failed","error","wrong","problem","issue","difficult"];
  const low=txt.toLowerCase();
  const posC=pos.filter(w=>low.includes(w)).length,negC=neg.filter(w=>low.includes(w)).length;
  const total=posC+negC||1;const posS=posC/total,negS=negC/total,neuS=Math.max(0,1-posS-negS);
  const label=posS>0.6?"positive":negS>0.6?"negative":posS>0.3&&negS>0.3?"mixed":"neutral";
  return {label,positive:Math.round(posS*100)/100,negative:Math.round(negS*100)/100,neutral:Math.round(neuS*100)/100,mixed:0};
};
const extractKeywords=txt=>{
  const stop=new Set(["the","a","an","and","or","but","in","on","at","to","for","of","with","is","are","was","were","be","been","have","has","had","do","does","did","will","would","could","should","may","might","this","that","these","those","i","you","he","she","we","they","it","its","not","no","so","if","as","by","from","up","out","about","into","than","then","when","who","what","how","why","which"]);
  const words=txt.toLowerCase().match(/\b[a-z]{3,}\b/g)||[];
  const freq={};words.forEach(w=>{if(!stop.has(w))freq[w]=(freq[w]||0)+1;});
  const max=Math.max(...Object.values(freq),1);
  return Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,8).map(([word,count])=>({word,score:Math.round((count/max)*100)/100}));
};
const extractEntities=txt=>{
  const entities=[],seen=new Set();
  const proper=txt.match(/(?<![.!?]\s)(?<!\bI\b\s)\b([A-Z][a-z]{2,}(?:\s[A-Z][a-z]+)*)\b/g)||[];
  proper.forEach(e=>{
    if(!seen.has(e.toLowerCase())&&e.length>2){
      seen.add(e.toLowerCase());
      const t=/city|town|country|india|london|york|delhi|mumbai|hyderabad/i.test(e)?"PLACE":/inc|ltd|corp|company|org|university|college/i.test(e)?"ORG":"PERSON";
      entities.push({name:e,type:t});
    }
  });
  return entities.slice(0,6);
};
const detectTone=txt=>{
  const low=txt.toLowerCase();
  return {
    formality:/therefore|however|furthermore|consequently|regarding/i.test(txt)?"Formal":/gonna|wanna|yeah|hey|lol|btw/i.test(low)?"Informal":"Neutral",
    emotion:(txt.match(/[!?]/g)||[]).length>1||/love|hate|amazing|terrible|excited|sad|happy|angry/i.test(low)?"Emotional":"Neutral",
    style:/should|must|important|crucial|believe|think|consider/i.test(low)?"Persuasive":/then|after|before|suddenly|finally|meanwhile/i.test(low)?"Narrative":"Conversational",
  };
};
const summarize=txt=>{const s=txt.match(/[^.!?]+[.!?]+/g)||[];return s.slice(0,2).join(" ").trim()||txt.slice(0,100)+"â€¦";};
const buildWA=(fmt,v)=>fmt.replace(/\{translation\}/g,v.translation||"").replace(/\{english\}/g,v.english||"").replace(/\{lang\}/g,v.lang||"").replace(/\{original\}/g,v.original||"").replace(/\{source\}/g,v.source||"").replace(/\\n/g,"\n");

/* â”€â”€â”€ TRANSLATION APIs â”€â”€â”€ */
const PROXY = "https://corsproxy.io/?";
const tryGoogle   = async(text,sl,tl)=>{const t=`https://translate.googleapis.com/translate_a/single?client=gtx&sl=${sl}&tl=${tl}&dt=t&q=${encodeURIComponent(text)}`;const r=await fetch(PROXY+encodeURIComponent(t),{signal:AbortSignal.timeout(6000)});if(!r.ok)throw new Error(`HTTP ${r.status}`);const d=await r.json();const out=d[0]?.map(c=>c?.[0]).filter(Boolean).join("").trim();if(!out)throw new Error("Empty");return out;};
const tryMyMemory = async(text,lp)=>{const t=`https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${lp}`;const r=await fetch(PROXY+encodeURIComponent(t),{signal:AbortSignal.timeout(6000)});if(!r.ok)throw new Error(`HTTP ${r.status}`);const d=await r.json();const out=d.responseData?.translatedText||"";if(!out||/quota|must be/i.test(out))throw new Error("Quota");return out;};
const tryLingva   = async(text,sl,tl)=>{const t=`https://lingva.ml/api/v1/${sl}/${tl}/${encodeURIComponent(text)}`;const r=await fetch(PROXY+encodeURIComponent(t),{signal:AbortSignal.timeout(6000)});if(!r.ok)throw new Error(`HTTP ${r.status}`);const d=await r.json();if(!d.translation)throw new Error("Empty");return d.translation;};
const tryClaude   = async(text,langName)=>{const r=await fetch("https://api.anthropic.com/v1/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:"claude-sonnet-4-20250514",max_tokens:400,system:`Translate to ${langName} script only. Output ONLY the translated text, nothing else.`,messages:[{role:"user",content:text}]})});const d=await r.json();if(d.error)throw new Error(d.error.message);const out=d.content?.[0]?.text?.trim();if(!out)throw new Error("Empty");return out;};

const translateFree = async(text, langPair, langName, src="auto")=>{
  const[sl,tl]=langPair.split("|"); const log=[];
  if(src==="claude")  {try{return{text:await tryClaude(text,langName),  source:"claude"};  }catch(e){throw new Error("Claude: "+e.message);}}
  if(src==="google")  {try{return{text:await tryGoogle(text,sl,tl),     source:"google"};  }catch(e){throw new Error("Google unavailable â€” switch to Auto or Claude.");}}
  if(src==="mymemory"){try{return{text:await tryMyMemory(text,langPair),source:"mymemory"};}catch(e){throw new Error("MyMemory unavailable â€” switch to Auto or Claude.");}}
  if(src==="lingva")  {try{return{text:await tryLingva(text,sl,tl),     source:"lingva"};  }catch(e){throw new Error("Lingva unavailable â€” switch to Auto or Claude.");}}
  // Auto waterfall
  try{return{text:await tryGoogle(text,sl,tl),    source:"google"};  }catch(e){log.push("G");}
  try{return{text:await tryMyMemory(text,langPair),source:"mymemory"};}catch(e){log.push("M");}
  try{return{text:await tryLingva(text,sl,tl),    source:"lingva"};  }catch(e){log.push("L");}
  try{return{text:await tryClaude(text,langName), source:"claude"};  }catch(e){log.push("C");}
  throw new Error("All sources failed ["+log.join(",")+"]");
};

/* â”€â”€â”€ TOGGLE â”€â”€â”€ */
const Toggle=({on})=><div className={`toggle ${on?"on":"off"}`}><div className="toggle-dot"/></div>;

/* â”€â”€â”€ APP â”€â”€â”€ */
function Vaani(){
  const[dark,setDark]=useState(true);
  const[flags,setFlags]=useState(DEFAULT_FLAGS);
  const[ffOpen,setFfOpen]=useState(false);
  const[input,setInput]=useState("");
  const[lang,setLang]=useState(LANGS[0]);
  const[srcKey,setSrcKey]=useState("claude"); // default to Claude â€” guaranteed to work
  const[usedSrc,setUsedSrc]=useState(null);
  const[mode,setMode]=useState(null);
  const[output,setOutput]=useState("");
  const[engBack,setEngBack]=useState("");
  const[loading,setLoading]=useState(false);
  const[error,setError]=useState("");
  const[nlp,setNlp]=useState(null);
  const[nlpDone,setNlpDone]=useState(false);
  const[apiSt,setApiSt]=useState("idle");
  const[copied,setCopied]=useState(null);
  const[wafmt,setWafmt]=useState(DEFAULT_FMT);
  const[fmtOpen,setFmtOpen]=useState(false);
  const[rtMode,setRtMode]=useState(false);
  const detectT=useRef(null),rtT=useRef(null);

  const toggleFlag=k=>{if(FLAG_CONFIG.find(f=>f.key===k)?.always)return;setFlags(p=>({...p,[k]:!p[k]}));};
  const detect=useCallback(txt=>setMode(detectTenglish(txt)?"tenglish":"english"),[]);
  const runNLP=useCallback(txt=>{if(!txt.trim())return;setNlpDone(false);setNlp({sentiment:analyzeSentiment(txt),keywords:extractKeywords(txt),entities:extractEntities(txt),tone:detectTone(txt),summary:summarize(txt),stats:textStats(txt)});setNlpDone(true);},[]);

  const translate=useCallback(async(txt,langOv)=>{
    if(!txt.trim())return;
    const ln=langOv||lang;
    setLoading(true);setError("");setOutput("");setEngBack("");setNlp(null);setNlpDone(false);setUsedSrc(null);setApiSt("pend");
    try{
      const res=await translateFree(txt,ln.mm,ln.name,srcKey);
      setOutput(res.text);setUsedSrc(res.source);setApiSt("ok");
      if(mode==="tenglish"){try{const b=await translateFree(res.text,`${ln.mm.split("|")[1]}|en`,"English",srcKey);setEngBack(b.text);}catch(_){}}
      runNLP(txt);
    }catch(e){
      setError(e.message||"Translation failed.");
      setApiSt("err");
    }finally{setLoading(false);}
  },[mode,lang,srcKey,runNLP]);

  const onInput=v=>{setInput(v);setMode(null);clearTimeout(detectT.current);if(v.trim().length>=4)detectT.current=setTimeout(()=>detect(v),400);if(rtMode){clearTimeout(rtT.current);if(v.trim().length>3)rtT.current=setTimeout(()=>translate(v),1600);}};
  const clear=()=>{setInput("");setOutput("");setEngBack("");setNlp(null);setNlpDone(false);setError("");setMode(null);setApiSt("idle");setCopied(null);setUsedSrc(null);};
  const copy=(txt,key)=>{navigator.clipboard.writeText(txt);setCopied(key);setTimeout(()=>setCopied(null),2200);};

  const srcMeta=usedSrc?SOURCES.find(s=>s.key===usedSrc):null;
  const waPreview=buildWA(wafmt,{translation:output||"[translation]",english:engBack||input||"[original]",lang:lang.name,original:input||"[original]",source:srcMeta?`${srcMeta.ico} ${srcMeta.name}`:"[source]"});
  const anyNLP=flags.sentiment||flags.keywords||flags.entities||flags.tone||flags.readability||flags.stats||flags.summary;
  const stats=nlp?.stats;const rm=stats?readMeta(stats.fk):null;

  return(<>
    <style>{CSS(dark)}</style>
    <div className="page">

      {/* NAV */}
      <nav className="nav">
        <div className="brand"><div className="b-ico">ğŸŒ</div><div><div className="b-name">Vaani</div><div className="b-tag">Free Â· Open Â· Community</div></div></div>
        <div className="nav-r">
          <button className={`pill ${rtMode?"on":""}`} onClick={()=>setRtMode(p=>!p)}>âš¡ Live</button>
          <button className="pill" onClick={()=>setFfOpen(p=>!p)}>âš™ Features</button>
          <button className="round" onClick={()=>setDark(d=>!d)}>{dark?"â˜€ï¸":"ğŸŒ™"}</button>
        </div>
      </nav>

      {/* SOURCE SELECTOR */}
      <div className="src-wrap">
        <div className="src-bar">
          <div className="src-lbl">Source â†’</div>
          <div className="src-chips">
            {SOURCES.map(s=>(
              <div key={s.key} className={`src-chip s-${s.key} ${srcKey===s.key?"active":""}`}
                onClick={()=>{setSrcKey(s.key);setUsedSrc(null);setOutput("");setError("");}}>
                <div className="src-ico" style={{color:s.color,background:srcKey===s.key?"rgba(255,255,255,.1)":"var(--surf2)"}}>{s.ico}</div>
                <div><div className="src-name">{s.name}</div><div className="src-note">{s.note}</div></div>
              </div>
            ))}
          </div>
        </div>
      </div>

      {/* FEATURE FLAGS */}
      <div className="ff-wrap">
        {ffOpen&&<div className="ff-panel">
          <div className="ff-head" onClick={()=>setFfOpen(false)}>
            <div className="ff-title">âš™ Feature Flags</div>
            <span style={{color:"var(--muted)",fontSize:12}}>âœ•</span>
          </div>
          <div className="ff-body">
            {FLAG_CONFIG.map(f=>(
              <div key={f.key} className={`ff-chip ${flags[f.key]?"on":""}`}
                onClick={()=>toggleFlag(f.key)} style={{opacity:f.always?.7:1,cursor:f.always?"default":"pointer"}}>
                <div><div style={{display:"flex",alignItems:"center",gap:5}}><span>{f.ico}</span><div className="ff-label">{f.label}</div></div><div className="ff-sub">{f.always?"Always On":f.sub}</div></div>
                {!f.always&&<Toggle on={flags[f.key]}/>}
              </div>
            ))}
          </div>
        </div>}
      </div>

      {/* LANG BAR */}
      <div className="lbar">
        <div className="lbl">â†’ To</div>
        <div className="lchips">
          {LANGS.map(l=><button key={l.code} className={`lchip ${lang.code===l.code?"on":""}`}
            onClick={()=>{setLang(l);setOutput("");setNlp(null);setNlpDone(false);setUsedSrc(null);}}>
            {l.flag} {l.name}</button>)}
        </div>
      </div>

      {/* STATUS */}
      <div className="mrow">
        {apiSt==="ok"  &&<><div className="api-dot ok"/><div className="mbadge api-ok">OK</div></>}
        {apiSt==="err" &&<><div className="api-dot err"/><div className="mbadge api-err">Error</div></>}
        {apiSt==="pend"&&<><div className="api-dot pend"/><div className="mbadge det">Translatingâ€¦</div></>}
        {mode&&<div className={`mbadge ${mode}`}>{mode==="tenglish"?"ğŸ”¤ Tenglish":"ğŸŒ English"}</div>}
        {!mode&&input.trim().length>=4&&<div className="mbadge det">â—Œ Detectingâ€¦</div>}
      </div>

      <div className="main">
        <div className="panels">
          {/* INPUT */}
          <div className="panel">
            <div className="ph"><div><div className="ph-lbl">Input</div><div className="ph-name">{mode==="tenglish"?"Tenglish":"English / Tenglish"}</div></div><div className="ph-cnt">{input.length}ch</div></div>
            <textarea value={input} onChange={e=>onInput(e.target.value)} placeholder={"English or Tenglishâ€¦\ne.g. \"nuvvu ela unnav?\""} onKeyDown={e=>{if((e.metaKey||e.ctrlKey)&&e.key==="Enter")translate(input);}}/>
            <div className="pa"><button className="ib" onClick={clear}>âœ• Clear</button>{input&&<button className={`ib ${copied==="in"?"ok":""}`} onClick={()=>copy(input,"in")}>{copied==="in"?"âœ“":"â˜"} Copy</button>}</div>
          </div>

          {/* ARROW */}
          <div className="arr"><button className="arrc" onClick={()=>translate(input)} disabled={loading||!input.trim()}>{loading?<div className="spin"/>:"â†’"}</button></div>

          {/* OUTPUT */}
          <div className="panel">
            <div className="ph">
              <div><div className="ph-lbl">Output Â· {lang.name}</div><div className="ph-name">{lang.name} Script</div></div>
              <div className="ph-right">
                {output&&<div className="ph-cnt">{output.length}ch</div>}
                {usedSrc&&srcMeta&&<div className={`src-badge b-${srcMeta.key}`}>{srcMeta.ico} {srcMeta.name}</div>}
                {apiSt==="err"&&<div className="src-badge b-failed">âœ• Failed</div>}
              </div>
            </div>
            <div className="ob">
              {loading?<span className="o-ph">Translating via {SOURCES.find(s=>s.key===srcKey)?.name}â€¦</span>
              :output?<><div className={lang.font}>{output}</div>{engBack&&<div className="o-eng"><div className="o-el">Back Translation</div><div className="o-et">{engBack}</div></div>}</>
              :<span className="o-ph">Translation appears here</span>}
            </div>
            {error&&<div className="err">âš  {error}</div>}
            {output&&<div className="pa">
              <button className={`ib ${copied==="out"?"ok":""}`} onClick={()=>copy(output,"out")}>{copied==="out"?"âœ“ Copied":"â˜ "+lang.name}</button>
              <button className={`ib ${copied==="both"?"ok":""}`} onClick={()=>copy(`${input}\n${output}`,"both")}>{copied==="both"?"âœ“":"ğŸ“‹"} Both</button>
            </div>}
          </div>
        </div>

        {/* CTA */}
        {!rtMode&&<button className="cta" onClick={()=>translate(input)} disabled={loading||!input.trim()}>
          {loading?<><div className="spin"/>Translating via {SOURCES.find(s=>s.key===srcKey)?.name}â€¦</>:<>Translate to {lang.name} Â· {SOURCES.find(s=>s.key===srcKey)?.name} <span style={{fontSize:10,opacity:.55,fontFamily:"DM Mono"}}>âŒ˜â†µ</span></>}
        </button>}

        {/* MESSAGING COPY */}
        {flags.whatsapp&&output&&<div className="wa-wrap">
          <div className="wa-head"><div className="wa-title">ğŸ’¬ Messaging Copy</div><button className="ib" onClick={()=>setFmtOpen(p=>!p)}>{fmtOpen?"âœ• Close":"âœ Customise"}</button></div>
          <div className="wa-body">
            {fmtOpen&&<div className="fmt-wrap">
              <div className="fmt-lbl">Format â€” click tokens to insert</div>
              <div className="fmt-tags">{FMT_TOKENS.map(t=><button key={t.token} className="fmt-tag" onClick={()=>setWafmt(p=>p+t.token)}>{t.label}</button>)}</div>
              <textarea value={wafmt} onChange={e=>setWafmt(e.target.value)} rows={4} style={{background:"var(--surf)",border:"1px solid var(--brd)",borderRadius:8,padding:"8px 11px",fontFamily:"DM Mono,monospace",fontSize:12,color:"var(--txt)",outline:"none",width:"100%",resize:"vertical"}}/>
              <div style={{display:"flex",gap:8}}>
                <button className="ib" onClick={()=>setWafmt(DEFAULT_FMT)}>â†º Reset</button>
                <button className="ib" onClick={()=>setWafmt("{translation}")}>Plain</button>
                <button className="ib" onClick={()=>setWafmt("ğŸŒ *{lang}*\n{translation}\n\nğŸ’¬ _{english}_")}>No Source</button>
              </div>
            </div>}
            <div><div style={{fontFamily:"DM Mono",fontSize:9,letterSpacing:".12em",textTransform:"uppercase",color:"var(--muted)",marginBottom:6}}>Preview</div><div className="wa-preview">{waPreview}</div></div>
            <div className="wa-actions">
              <button className={`wa-btn ${copied==="wa"?"ok":""}`}    onClick={()=>copy(waPreview,"wa")} >{copied==="wa" ?"âœ“ Copied!":"ğŸ“‹ Copy for WhatsApp"}</button>
              <button className={`wa-btn tg ${copied==="tg"?"ok":""}`} onClick={()=>copy(waPreview,"tg")}>{copied==="tg" ?"âœ“ Copied!":"âœˆï¸ Copy for Telegram"}</button>
              <button className={`wa-btn cp ${copied==="sms"?"ok":""}`}onClick={()=>copy(output,"sms")}  >{copied==="sms"?"âœ“ Copied!":"ğŸ’¬ Script Only"}</button>
            </div>
          </div>
        </div>}

        {/* NLP */}
        {anyNLP&&nlpDone&&nlp&&<div className="nlp-section">
          <div className="section-title">â¬¡ NLP Analysis Â· Local Â· Free</div>
          <div className="nlp-grid">
            {flags.sentiment&&(()=>{const s=nlp.sentiment,m=SENT_META[s.label]||SENT_META.neutral;return(
              <div className="card"><div className="card-h"><div className="card-ico ic-a">ğŸ’¬</div><div className="card-title">Sentiment</div></div><div className="card-body">
                <div className="sent-top"><div><div className="sent-score" style={{color:m.color}}>{pct(s[s.label])}</div><div className="sent-lbl" style={{color:m.color}}>{m.label}</div></div><div className="sent-emo">{m.emo}</div></div>
                <div className="bars">{["positive","negative","neutral"].map(k=><div className="bar-row" key={k}><div className="bar-k">{k}</div><div className="bar-track"><div className={`bar-fill ${k}`} style={{"--w":pct(s[k])}}/></div><div className="bar-pct">{pct(s[k])}</div></div>)}</div>
              </div></div>
            );})()}
            {flags.keywords&&<div className="card"><div className="card-h"><div className="card-ico ic-k">ğŸ”‘</div><div className="card-title">Key Terms</div></div><div className="card-body"><div className="kw-cloud">{nlp.keywords.map((k,i)=><span key={i} className={`kw-tag ${i===0?"h1":i<3?"h2":"h3"}`}>{k.word}<span className="kw-score">{Math.round(k.score*100)}</span></span>)}</div></div></div>}
          </div>
          <div className="nlp-grid-3">
            {flags.entities&&<div className="card"><div className="card-h"><div className="card-ico ic-e">ğŸ·ï¸</div><div className="card-title">Entities</div></div><div className="card-body">{nlp.entities?.length?<div className="ent-list">{nlp.entities.slice(0,5).map((e,i)=><div className="ent-row" key={i}><div className={`ent-badge ${e.type}`}>{e.type}</div><div className="ent-name">{e.name}</div></div>)}</div>:<div style={{color:"var(--muted)",fontStyle:"italic",fontSize:12}}>None found</div>}</div></div>}
            {flags.tone&&<div className="card"><div className="card-h"><div className="card-ico ic-t">ğŸ­</div><div className="card-title">Tone</div></div><div className="card-body"><div className="tone-grid">{[{l:"Formality",v:nlp.tone?.formality},{l:"Emotion",v:nlp.tone?.emotion},{l:"Style",v:nlp.tone?.style},{l:"Language",v:mode==="tenglish"?"Tenglish":"English"}].map((t,i)=><div className={`tone-item ${i<2?"hi":""}`} key={i}><div className="tone-lbl">{t.l}</div><div className="tone-val">{t.v||"â€”"}</div></div>)}</div></div></div>}
            {flags.readability&&rm&&<div className="card"><div className="card-h"><div className="card-ico ic-r">ğŸ“–</div><div className="card-title">Readability</div></div><div className="card-body"><div className="read-score" style={{color:rm.color}}>{stats.fk}</div><div className="read-grade">{rm.label}</div><div className="read-meter"><div className="read-fill" style={{width:stats.fk+"%",background:rm.color}}/></div><div className="read-desc">{rm.desc}</div></div></div>}
          </div>
          <div className="nlp-grid">
            {flags.stats&&stats&&<div className="card"><div className="card-h"><div className="card-ico ic-s">ğŸ“Š</div><div className="card-title">Text Statistics</div></div><div className="card-body"><div className="stats-grid">{[{n:stats.words,l:"Words"},{n:stats.sentences,l:"Sentences"},{n:stats.chars,l:"Chars"},{n:stats.syllables,l:"Syllables"},{n:stats.avgWL,l:"Avg Len"},{n:stats.words&&stats.sentences?Math.round(stats.words/Math.max(stats.sentences,1)):0,l:"Words/Sent"}].map((s,i)=><div className="stat-box" key={i}><div className="stat-n">{s.n}</div><div className="stat-l">{s.l}</div></div>)}</div></div></div>}
            {flags.summary&&<div className="card"><div className="card-h"><div className="card-ico ic-n">ğŸ“</div><div className="card-title">Summary & Compare</div></div><div className="card-body">{nlp.summary&&<p className="sum-text">"{nlp.summary}"</p>}{input&&output&&<><div className="sum-divider"/><div style={{display:"flex",flexDirection:"column",gap:8}}><div><div className="cmp-lbl">English</div><div className="cmp-txt">{input.slice(0,100)}{input.length>100?"â€¦":""}</div></div><div><div className="cmp-lbl">{lang.name}</div><div className={`cmp-txt ${lang.cmp}`}>{output.slice(0,80)}{output.length>80?"â€¦":""}</div></div></div></>}</div></div>}
          </div>
        </div>}

        <div className="footer">âˆ Free Â· Open Source Â· No Login Â· No Tracking</div>
      </div>
    </div>
  </>);
}

ReactDOM.createRoot(document.getElementById("root")).render(<Vaani/>);
</script>
<script>if("serviceWorker" in navigator)window.addEventListener("load",()=>navigator.serviceWorker.register("/sw.js").catch(()=>{}));</script>
</body>
</html>
